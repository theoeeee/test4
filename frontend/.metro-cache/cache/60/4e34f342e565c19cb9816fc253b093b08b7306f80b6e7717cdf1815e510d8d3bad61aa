{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":53,"index":213}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":214},"end":{"line":4,"column":38,"index":252}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _servicesApi = require(_dependencyMap[3], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function useProtectedRoute(user, isLoading) {\n    const segments = (0, _expoRouter.useSegments)();\n    const router = (0, _expoRouter.useRouter)();\n    (0, _react.useEffect)(() => {\n      if (isLoading) return;\n      const inAuthGroup = segments[0] === 'auth';\n      const inAdminGroup = segments[0] === 'admin';\n      const inDriverGroup = segments[0] === 'driver';\n      const isIndex = segments.length === 0 || segments[0] === undefined;\n      if (user) {\n        // User is logged in\n        if (inAuthGroup || isIndex) {\n          // Redirect to appropriate dashboard based on role\n          if (user.role === 'admin' || user.role === 'supervisor') {\n            router.replace('/admin/dashboard');\n          } else {\n            router.replace('/driver/home');\n          }\n        }\n      }\n    }, [user, segments, isLoading]);\n  }\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    useProtectedRoute(user, isLoading);\n    (0, _react.useEffect)(() => {\n      loadUser();\n    }, []);\n    const loadUser = async () => {\n      try {\n        const userData = await AsyncStorage.default.getItem('user');\n        if (userData) {\n          setUser(JSON.parse(userData));\n        }\n      } catch (error) {\n        console.error('Error loading user:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      try {\n        const response = await _servicesApi.api.post('/auth/login', {\n          email,\n          password\n        });\n        const userData = response.data.user;\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Erreur de connexion');\n      }\n    };\n    const register = async userData => {\n      try {\n        const response = await _servicesApi.api.post('/auth/register', userData);\n        const user = response.data.user;\n        await AsyncStorage.default.setItem('user', JSON.stringify(user));\n        setUser(user);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || \"Erreur lors de l'inscription\");\n      }\n    };\n    const logout = async () => {\n      try {\n        await AsyncStorage.default.removeItem('user');\n        setUser(null);\n      } catch (error) {\n        console.error('Error logging out:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        register,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":118,"map":[[13,2,53,0,"exports"],[13,9,53,0],[13,10,53,0,"AuthProvider"],[13,22,53,0],[13,25,53,0,"AuthProvider"],[13,37,53,0],[14,2,114,0,"exports"],[14,9,114,0],[14,10,114,0,"useAuth"],[14,17,114,0],[14,20,114,0,"useAuth"],[14,27,114,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_expoRouter"],[18,17,3,0],[18,20,3,0,"require"],[18,27,3,0],[18,28,3,0,"_dependencyMap"],[18,42,3,0],[19,2,4,0],[19,6,4,0,"_servicesApi"],[19,18,4,0],[19,21,4,0,"require"],[19,28,4,0],[19,29,4,0,"_dependencyMap"],[19,43,4,0],[20,2,4,38],[20,6,4,38,"_reactJsxDevRuntime"],[20,25,4,38],[20,28,4,38,"require"],[20,35,4,38],[20,36,4,38,"_dependencyMap"],[20,50,4,38],[21,2,25,0],[21,8,25,6,"AuthContext"],[21,19,25,17],[21,35,25,20],[21,39,25,20,"createContext"],[21,45,25,33],[21,46,25,33,"createContext"],[21,59,25,33],[21,61,25,63,"undefined"],[21,70,25,72],[21,71,25,73],[22,2,27,0],[22,11,27,9,"useProtectedRoute"],[22,28,27,26,"useProtectedRoute"],[22,29,27,27,"user"],[22,33,27,44],[22,35,27,46,"isLoading"],[22,44,27,64],[22,46,27,66],[23,4,28,2],[23,10,28,8,"segments"],[23,18,28,16],[23,21,28,19],[23,25,28,19,"useSegments"],[23,36,28,30],[23,37,28,30,"useSegments"],[23,48,28,30],[23,50,28,31],[23,51,28,32],[24,4,29,2],[24,10,29,8,"router"],[24,16,29,14],[24,19,29,17],[24,23,29,17,"useRouter"],[24,34,29,26],[24,35,29,26,"useRouter"],[24,44,29,26],[24,46,29,27],[24,47,29,28],[25,4,31,2],[25,8,31,2,"useEffect"],[25,14,31,11],[25,15,31,11,"useEffect"],[25,24,31,11],[25,26,31,12],[25,32,31,18],[26,6,32,4],[26,10,32,8,"isLoading"],[26,19,32,17],[26,21,32,19],[27,6,34,4],[27,12,34,10,"inAuthGroup"],[27,23,34,21],[27,26,34,24,"segments"],[27,34,34,32],[27,35,34,33],[27,36,34,34],[27,37,34,35],[27,42,34,40],[27,48,34,46],[28,6,35,4],[28,12,35,10,"inAdminGroup"],[28,24,35,22],[28,27,35,25,"segments"],[28,35,35,33],[28,36,35,34],[28,37,35,35],[28,38,35,36],[28,43,35,41],[28,50,35,48],[29,6,36,4],[29,12,36,10,"inDriverGroup"],[29,25,36,23],[29,28,36,26,"segments"],[29,36,36,34],[29,37,36,35],[29,38,36,36],[29,39,36,37],[29,44,36,42],[29,52,36,50],[30,6,37,4],[30,12,37,10,"isIndex"],[30,19,37,17],[30,22,37,20,"segments"],[30,30,37,28],[30,31,37,29,"length"],[30,37,37,35],[30,42,37,40],[30,43,37,41],[30,47,37,45,"segments"],[30,55,37,53],[30,56,37,54],[30,57,37,55],[30,58,37,56],[30,63,37,61,"undefined"],[30,72,37,70],[31,6,39,4],[31,10,39,8,"user"],[31,14,39,12],[31,16,39,14],[32,8,40,6],[33,8,41,6],[33,12,41,10,"inAuthGroup"],[33,23,41,21],[33,27,41,25,"isIndex"],[33,34,41,32],[33,36,41,34],[34,10,42,8],[35,10,43,8],[35,14,43,12,"user"],[35,18,43,16],[35,19,43,17,"role"],[35,23,43,21],[35,28,43,26],[35,35,43,33],[35,39,43,37,"user"],[35,43,43,41],[35,44,43,42,"role"],[35,48,43,46],[35,53,43,51],[35,65,43,63],[35,67,43,65],[36,12,44,10,"router"],[36,18,44,16],[36,19,44,17,"replace"],[36,26,44,24],[36,27,44,25],[36,45,44,43],[36,46,44,44],[37,10,45,8],[37,11,45,9],[37,17,45,15],[38,12,46,10,"router"],[38,18,46,16],[38,19,46,17,"replace"],[38,26,46,24],[38,27,46,25],[38,41,46,39],[38,42,46,40],[39,10,47,8],[40,8,48,6],[41,6,49,4],[42,4,50,2],[42,5,50,3],[42,7,50,5],[42,8,50,6,"user"],[42,12,50,10],[42,14,50,12,"segments"],[42,22,50,20],[42,24,50,22,"isLoading"],[42,33,50,31],[42,34,50,32],[42,35,50,33],[43,2,51,0],[44,2,53,7],[44,11,53,16,"AuthProvider"],[44,23,53,28,"AuthProvider"],[44,24,53,29],[45,4,53,31,"children"],[46,2,53,65],[46,3,53,66],[46,5,53,68],[47,4,54,2],[47,10,54,8],[47,11,54,9,"user"],[47,15,54,13],[47,17,54,15,"setUser"],[47,24,54,22],[47,25,54,23],[47,28,54,26],[47,32,54,26,"useState"],[47,38,54,34],[47,39,54,34,"useState"],[47,47,54,34],[47,49,54,48],[47,53,54,52],[47,54,54,53],[48,4,55,2],[48,10,55,8],[48,11,55,9,"isLoading"],[48,20,55,18],[48,22,55,20,"setIsLoading"],[48,34,55,32],[48,35,55,33],[48,38,55,36],[48,42,55,36,"useState"],[48,48,55,44],[48,49,55,44,"useState"],[48,57,55,44],[48,59,55,45],[48,63,55,49],[48,64,55,50],[49,4,57,2,"useProtectedRoute"],[49,21,57,19],[49,22,57,20,"user"],[49,26,57,24],[49,28,57,26,"isLoading"],[49,37,57,35],[49,38,57,36],[50,4,59,2],[50,8,59,2,"useEffect"],[50,14,59,11],[50,15,59,11,"useEffect"],[50,24,59,11],[50,26,59,12],[50,32,59,18],[51,6,60,4,"loadUser"],[51,14,60,12],[51,15,60,13],[51,16,60,14],[52,4,61,2],[52,5,61,3],[52,7,61,5],[52,9,61,7],[52,10,61,8],[53,4,63,2],[53,10,63,8,"loadUser"],[53,18,63,16],[53,21,63,19],[53,27,63,19,"loadUser"],[53,28,63,19],[53,33,63,31],[54,6,64,4],[54,10,64,8],[55,8,65,6],[55,14,65,12,"userData"],[55,22,65,20],[55,25,65,23],[55,31,65,29,"AsyncStorage"],[55,43,65,41],[55,44,65,41,"default"],[55,51,65,41],[55,52,65,42,"getItem"],[55,59,65,49],[55,60,65,50],[55,66,65,56],[55,67,65,57],[56,8,66,6],[56,12,66,10,"userData"],[56,20,66,18],[56,22,66,20],[57,10,67,8,"setUser"],[57,17,67,15],[57,18,67,16,"JSON"],[57,22,67,20],[57,23,67,21,"parse"],[57,28,67,26],[57,29,67,27,"userData"],[57,37,67,35],[57,38,67,36],[57,39,67,37],[58,8,68,6],[59,6,69,4],[59,7,69,5],[59,8,69,6],[59,15,69,13,"error"],[59,20,69,18],[59,22,69,20],[60,8,70,6,"console"],[60,15,70,13],[60,16,70,14,"error"],[60,21,70,19],[60,22,70,20],[60,43,70,41],[60,45,70,43,"error"],[60,50,70,48],[60,51,70,49],[61,6,71,4],[61,7,71,5],[61,16,71,14],[62,8,72,6,"setIsLoading"],[62,20,72,18],[62,21,72,19],[62,26,72,24],[62,27,72,25],[63,6,73,4],[64,4,74,2],[64,5,74,3],[65,4,76,2],[65,10,76,8,"login"],[65,15,76,13],[65,18,76,16],[65,24,76,16,"login"],[65,25,76,23,"email"],[65,30,76,36],[65,32,76,38,"password"],[65,40,76,54],[65,45,76,59],[66,6,77,4],[66,10,77,8],[67,8,78,6],[67,14,78,12,"response"],[67,22,78,20],[67,25,78,23],[67,31,78,29,"api"],[67,43,78,32],[67,44,78,32,"api"],[67,47,78,32],[67,48,78,33,"post"],[67,52,78,37],[67,53,78,38],[67,66,78,51],[67,68,78,53],[68,10,78,55,"email"],[68,15,78,60],[69,10,78,62,"password"],[70,8,78,71],[70,9,78,72],[70,10,78,73],[71,8,79,6],[71,14,79,12,"userData"],[71,22,79,20],[71,25,79,23,"response"],[71,33,79,31],[71,34,79,32,"data"],[71,38,79,36],[71,39,79,37,"user"],[71,43,79,41],[72,8,80,6],[72,14,80,12,"AsyncStorage"],[72,26,80,24],[72,27,80,24,"default"],[72,34,80,24],[72,35,80,25,"setItem"],[72,42,80,32],[72,43,80,33],[72,49,80,39],[72,51,80,41,"JSON"],[72,55,80,45],[72,56,80,46,"stringify"],[72,65,80,55],[72,66,80,56,"userData"],[72,74,80,64],[72,75,80,65],[72,76,80,66],[73,8,81,6,"setUser"],[73,15,81,13],[73,16,81,14,"userData"],[73,24,81,22],[73,25,81,23],[74,6,82,4],[74,7,82,5],[74,8,82,6],[74,15,82,13,"error"],[74,20,82,23],[74,22,82,25],[75,8,83,6],[75,14,83,12],[75,18,83,16,"Error"],[75,23,83,21],[75,24,83,22,"error"],[75,29,83,27],[75,30,83,28,"response"],[75,38,83,36],[75,40,83,38,"data"],[75,44,83,42],[75,46,83,44,"detail"],[75,52,83,50],[75,56,83,54],[75,77,83,75],[75,78,83,76],[76,6,84,4],[77,4,85,2],[77,5,85,3],[78,4,87,2],[78,10,87,8,"register"],[78,18,87,16],[78,21,87,19],[78,27,87,26,"userData"],[78,35,87,39],[78,39,87,44],[79,6,88,4],[79,10,88,8],[80,8,89,6],[80,14,89,12,"response"],[80,22,89,20],[80,25,89,23],[80,31,89,29,"api"],[80,43,89,32],[80,44,89,32,"api"],[80,47,89,32],[80,48,89,33,"post"],[80,52,89,37],[80,53,89,38],[80,69,89,54],[80,71,89,56,"userData"],[80,79,89,64],[80,80,89,65],[81,8,90,6],[81,14,90,12,"user"],[81,18,90,16],[81,21,90,19,"response"],[81,29,90,27],[81,30,90,28,"data"],[81,34,90,32],[81,35,90,33,"user"],[81,39,90,37],[82,8,91,6],[82,14,91,12,"AsyncStorage"],[82,26,91,24],[82,27,91,24,"default"],[82,34,91,24],[82,35,91,25,"setItem"],[82,42,91,32],[82,43,91,33],[82,49,91,39],[82,51,91,41,"JSON"],[82,55,91,45],[82,56,91,46,"stringify"],[82,65,91,55],[82,66,91,56,"user"],[82,70,91,60],[82,71,91,61],[82,72,91,62],[83,8,92,6,"setUser"],[83,15,92,13],[83,16,92,14,"user"],[83,20,92,18],[83,21,92,19],[84,6,93,4],[84,7,93,5],[84,8,93,6],[84,15,93,13,"error"],[84,20,93,23],[84,22,93,25],[85,8,94,6],[85,14,94,12],[85,18,94,16,"Error"],[85,23,94,21],[85,24,94,22,"error"],[85,29,94,27],[85,30,94,28,"response"],[85,38,94,36],[85,40,94,38,"data"],[85,44,94,42],[85,46,94,44,"detail"],[85,52,94,50],[85,56,94,54],[85,86,94,84],[85,87,94,85],[86,6,95,4],[87,4,96,2],[87,5,96,3],[88,4,98,2],[88,10,98,8,"logout"],[88,16,98,14],[88,19,98,17],[88,25,98,17,"logout"],[88,26,98,17],[88,31,98,29],[89,6,99,4],[89,10,99,8],[90,8,100,6],[90,14,100,12,"AsyncStorage"],[90,26,100,24],[90,27,100,24,"default"],[90,34,100,24],[90,35,100,25,"removeItem"],[90,45,100,35],[90,46,100,36],[90,52,100,42],[90,53,100,43],[91,8,101,6,"setUser"],[91,15,101,13],[91,16,101,14],[91,20,101,18],[91,21,101,19],[92,6,102,4],[92,7,102,5],[92,8,102,6],[92,15,102,13,"error"],[92,20,102,18],[92,22,102,20],[93,8,103,6,"console"],[93,15,103,13],[93,16,103,14,"error"],[93,21,103,19],[93,22,103,20],[93,42,103,40],[93,44,103,42,"error"],[93,49,103,47],[93,50,103,48],[94,6,104,4],[95,4,105,2],[95,5,105,3],[96,4,107,2],[96,24,108,4],[96,28,108,4,"_reactJsxDevRuntime"],[96,47,108,4],[96,48,108,4,"jsxDEV"],[96,54,108,4],[96,56,108,5,"AuthContext"],[96,67,108,16],[96,68,108,17,"Provider"],[96,76,108,25],[97,6,108,26,"value"],[97,11,108,31],[97,13,108,33],[98,8,108,35,"user"],[98,12,108,39],[99,8,108,41,"isLoading"],[99,17,108,50],[100,8,108,52,"login"],[100,13,108,57],[101,8,108,59,"register"],[101,16,108,67],[102,8,108,69,"logout"],[103,6,108,76],[103,7,108,78],[104,6,108,78,"children"],[104,14,108,78],[104,16,109,7,"children"],[105,4,109,15],[106,6,109,15,"fileName"],[106,14,109,15],[106,16,109,15,"_jsxFileName"],[106,28,109,15],[107,6,109,15,"lineNumber"],[107,16,109,15],[108,6,109,15,"columnNumber"],[108,18,109,15],[109,4,109,15],[109,11,110,26],[109,12,110,27],[110,2,112,0],[111,2,114,7],[111,11,114,16,"useAuth"],[111,18,114,23,"useAuth"],[111,19,114,23],[111,21,114,26],[112,4,115,2],[112,10,115,8,"context"],[112,17,115,15],[112,20,115,18],[112,24,115,18,"useContext"],[112,30,115,28],[112,31,115,28,"useContext"],[112,41,115,28],[112,43,115,29,"AuthContext"],[112,54,115,40],[112,55,115,41],[113,4,116,2],[113,8,116,6,"context"],[113,15,116,13],[113,20,116,18,"undefined"],[113,29,116,27],[113,31,116,29],[114,6,117,4],[114,12,117,10],[114,16,117,14,"Error"],[114,21,117,19],[114,22,117,20],[114,67,117,65],[114,68,117,66],[115,4,118,2],[116,4,119,2],[116,11,119,9,"context"],[116,18,119,16],[117,2,120,0],[118,0,120,1],[118,3]],"functionMap":{"names":["<global>","useProtectedRoute","useEffect$argument_0","AuthProvider","loadUser","login","register","logout","useAuth"],"mappings":"AAA;AC0B;YCI;GDmB;CDC;OGE;YDM;GCE;mBCE;GDW;gBEE;GFS;mBGE;GHS;iBIE;GJO;CHO;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}
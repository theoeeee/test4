{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":53,"index":213}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":214},"end":{"line":4,"column":38,"index":252}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _servicesApi = require(_dependencyMap[3], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function useProtectedRoute(user, isLoading) {\n    _s();\n    const segments = (0, _expoRouter.useSegments)();\n    const router = (0, _expoRouter.useRouter)();\n    (0, _react.useEffect)(() => {\n      if (isLoading) return;\n      const inAuthGroup = segments[0] === 'auth';\n      const inAdminGroup = segments[0] === 'admin';\n      const inDriverGroup = segments[0] === 'driver';\n      const isIndex = segments.length === 0 || segments[0] === undefined;\n      if (user) {\n        // User is logged in\n        if (inAuthGroup || isIndex) {\n          // Redirect to appropriate dashboard based on role\n          if (user.role === 'admin' || user.role === 'supervisor') {\n            router.replace('/admin/dashboard');\n          } else {\n            router.replace('/driver/home');\n          }\n        }\n      }\n    }, [user, segments, isLoading]);\n  }\n  _s(useProtectedRoute, \"TcDZ9QYGw7c0Y2ocodByH/4ZGVE=\", false, function () {\n    return [_expoRouter.useSegments, _expoRouter.useRouter];\n  });\n  function AuthProvider({\n    children\n  }) {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    useProtectedRoute(user, isLoading);\n    (0, _react.useEffect)(() => {\n      loadUser();\n    }, []);\n    const loadUser = async () => {\n      try {\n        const userData = await AsyncStorage.default.getItem('user');\n        if (userData) {\n          setUser(JSON.parse(userData));\n        }\n      } catch (error) {\n        console.error('Error loading user:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      try {\n        const response = await _servicesApi.api.post('/auth/login', {\n          email,\n          password\n        });\n        const userData = response.data.user;\n        await AsyncStorage.default.setItem('user', JSON.stringify(userData));\n        setUser(userData);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || 'Erreur de connexion');\n      }\n    };\n    const register = async userData => {\n      try {\n        const response = await _servicesApi.api.post('/auth/register', userData);\n        const user = response.data.user;\n        await AsyncStorage.default.setItem('user', JSON.stringify(user));\n        setUser(user);\n      } catch (error) {\n        throw new Error(error.response?.data?.detail || \"Erreur lors de l'inscription\");\n      }\n    };\n    const logout = async () => {\n      try {\n        await AsyncStorage.default.removeItem('user');\n        setUser(null);\n      } catch (error) {\n        console.error('Error logging out:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        register,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }, this);\n  }\n  _s2(AuthProvider, \"Gr9n23Mu0Di9Xq/TO3h1bB7+bpM=\", false, function () {\n    return [useProtectedRoute];\n  });\n  _c = AuthProvider;\n  function useAuth() {\n    _s3();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s3(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":134,"map":[[16,2,53,0,"exports"],[16,9,53,0],[16,10,53,0,"AuthProvider"],[16,22,53,0],[16,25,53,0,"AuthProvider"],[16,37,53,0],[17,2,114,0,"exports"],[17,9,114,0],[17,10,114,0,"useAuth"],[17,17,114,0],[17,20,114,0,"useAuth"],[17,27,114,0],[18,2,1,0],[18,6,1,0,"_react"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,2,0],[19,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,42,2,0],[19,45,2,0,"require"],[19,52,2,0],[19,53,2,0,"_dependencyMap"],[19,67,2,0],[20,2,2,0],[20,6,2,0,"AsyncStorage"],[20,18,2,0],[20,21,2,0,"_interopDefault"],[20,36,2,0],[20,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,73,2,0],[21,2,3,0],[21,6,3,0,"_expoRouter"],[21,17,3,0],[21,20,3,0,"require"],[21,27,3,0],[21,28,3,0,"_dependencyMap"],[21,42,3,0],[22,2,4,0],[22,6,4,0,"_servicesApi"],[22,18,4,0],[22,21,4,0,"require"],[22,28,4,0],[22,29,4,0,"_dependencyMap"],[22,43,4,0],[23,2,4,38],[23,6,4,38,"_reactJsxDevRuntime"],[23,25,4,38],[23,28,4,38,"require"],[23,35,4,38],[23,36,4,38,"_dependencyMap"],[23,50,4,38],[24,2,25,0],[24,8,25,6,"AuthContext"],[24,19,25,17],[24,35,25,20],[24,39,25,20,"createContext"],[24,45,25,33],[24,46,25,33,"createContext"],[24,59,25,33],[24,61,25,63,"undefined"],[24,70,25,72],[24,71,25,73],[25,2,27,0],[25,11,27,9,"useProtectedRoute"],[25,28,27,26,"useProtectedRoute"],[25,29,27,27,"user"],[25,33,27,44],[25,35,27,46,"isLoading"],[25,44,27,64],[25,46,27,66],[26,4,27,66,"_s"],[26,6,27,66],[27,4,28,2],[27,10,28,8,"segments"],[27,18,28,16],[27,21,28,19],[27,25,28,19,"useSegments"],[27,36,28,30],[27,37,28,30,"useSegments"],[27,48,28,30],[27,50,28,31],[27,51,28,32],[28,4,29,2],[28,10,29,8,"router"],[28,16,29,14],[28,19,29,17],[28,23,29,17,"useRouter"],[28,34,29,26],[28,35,29,26,"useRouter"],[28,44,29,26],[28,46,29,27],[28,47,29,28],[29,4,31,2],[29,8,31,2,"useEffect"],[29,14,31,11],[29,15,31,11,"useEffect"],[29,24,31,11],[29,26,31,12],[29,32,31,18],[30,6,32,4],[30,10,32,8,"isLoading"],[30,19,32,17],[30,21,32,19],[31,6,34,4],[31,12,34,10,"inAuthGroup"],[31,23,34,21],[31,26,34,24,"segments"],[31,34,34,32],[31,35,34,33],[31,36,34,34],[31,37,34,35],[31,42,34,40],[31,48,34,46],[32,6,35,4],[32,12,35,10,"inAdminGroup"],[32,24,35,22],[32,27,35,25,"segments"],[32,35,35,33],[32,36,35,34],[32,37,35,35],[32,38,35,36],[32,43,35,41],[32,50,35,48],[33,6,36,4],[33,12,36,10,"inDriverGroup"],[33,25,36,23],[33,28,36,26,"segments"],[33,36,36,34],[33,37,36,35],[33,38,36,36],[33,39,36,37],[33,44,36,42],[33,52,36,50],[34,6,37,4],[34,12,37,10,"isIndex"],[34,19,37,17],[34,22,37,20,"segments"],[34,30,37,28],[34,31,37,29,"length"],[34,37,37,35],[34,42,37,40],[34,43,37,41],[34,47,37,45,"segments"],[34,55,37,53],[34,56,37,54],[34,57,37,55],[34,58,37,56],[34,63,37,61,"undefined"],[34,72,37,70],[35,6,39,4],[35,10,39,8,"user"],[35,14,39,12],[35,16,39,14],[36,8,40,6],[37,8,41,6],[37,12,41,10,"inAuthGroup"],[37,23,41,21],[37,27,41,25,"isIndex"],[37,34,41,32],[37,36,41,34],[38,10,42,8],[39,10,43,8],[39,14,43,12,"user"],[39,18,43,16],[39,19,43,17,"role"],[39,23,43,21],[39,28,43,26],[39,35,43,33],[39,39,43,37,"user"],[39,43,43,41],[39,44,43,42,"role"],[39,48,43,46],[39,53,43,51],[39,65,43,63],[39,67,43,65],[40,12,44,10,"router"],[40,18,44,16],[40,19,44,17,"replace"],[40,26,44,24],[40,27,44,25],[40,45,44,43],[40,46,44,44],[41,10,45,8],[41,11,45,9],[41,17,45,15],[42,12,46,10,"router"],[42,18,46,16],[42,19,46,17,"replace"],[42,26,46,24],[42,27,46,25],[42,41,46,39],[42,42,46,40],[43,10,47,8],[44,8,48,6],[45,6,49,4],[46,4,50,2],[46,5,50,3],[46,7,50,5],[46,8,50,6,"user"],[46,12,50,10],[46,14,50,12,"segments"],[46,22,50,20],[46,24,50,22,"isLoading"],[46,33,50,31],[46,34,50,32],[46,35,50,33],[47,2,51,0],[48,2,51,1,"_s"],[48,4,51,1],[48,5,27,9,"useProtectedRoute"],[48,22,27,26],[49,4,27,26],[49,12,28,19,"useSegments"],[49,23,28,30],[49,24,28,30,"useSegments"],[49,35,28,30],[49,37,29,17,"useRouter"],[49,48,29,26],[49,49,29,26,"useRouter"],[49,58,29,26],[50,2,29,26],[51,2,53,7],[51,11,53,16,"AuthProvider"],[51,23,53,28,"AuthProvider"],[51,24,53,29],[52,4,53,31,"children"],[53,2,53,65],[53,3,53,66],[53,5,53,68],[54,4,53,68,"_s2"],[54,7,53,68],[55,4,54,2],[55,10,54,8],[55,11,54,9,"user"],[55,15,54,13],[55,17,54,15,"setUser"],[55,24,54,22],[55,25,54,23],[55,28,54,26],[55,32,54,26,"useState"],[55,38,54,34],[55,39,54,34,"useState"],[55,47,54,34],[55,49,54,48],[55,53,54,52],[55,54,54,53],[56,4,55,2],[56,10,55,8],[56,11,55,9,"isLoading"],[56,20,55,18],[56,22,55,20,"setIsLoading"],[56,34,55,32],[56,35,55,33],[56,38,55,36],[56,42,55,36,"useState"],[56,48,55,44],[56,49,55,44,"useState"],[56,57,55,44],[56,59,55,45],[56,63,55,49],[56,64,55,50],[57,4,57,2,"useProtectedRoute"],[57,21,57,19],[57,22,57,20,"user"],[57,26,57,24],[57,28,57,26,"isLoading"],[57,37,57,35],[57,38,57,36],[58,4,59,2],[58,8,59,2,"useEffect"],[58,14,59,11],[58,15,59,11,"useEffect"],[58,24,59,11],[58,26,59,12],[58,32,59,18],[59,6,60,4,"loadUser"],[59,14,60,12],[59,15,60,13],[59,16,60,14],[60,4,61,2],[60,5,61,3],[60,7,61,5],[60,9,61,7],[60,10,61,8],[61,4,63,2],[61,10,63,8,"loadUser"],[61,18,63,16],[61,21,63,19],[61,27,63,19,"loadUser"],[61,28,63,19],[61,33,63,31],[62,6,64,4],[62,10,64,8],[63,8,65,6],[63,14,65,12,"userData"],[63,22,65,20],[63,25,65,23],[63,31,65,29,"AsyncStorage"],[63,43,65,41],[63,44,65,41,"default"],[63,51,65,41],[63,52,65,42,"getItem"],[63,59,65,49],[63,60,65,50],[63,66,65,56],[63,67,65,57],[64,8,66,6],[64,12,66,10,"userData"],[64,20,66,18],[64,22,66,20],[65,10,67,8,"setUser"],[65,17,67,15],[65,18,67,16,"JSON"],[65,22,67,20],[65,23,67,21,"parse"],[65,28,67,26],[65,29,67,27,"userData"],[65,37,67,35],[65,38,67,36],[65,39,67,37],[66,8,68,6],[67,6,69,4],[67,7,69,5],[67,8,69,6],[67,15,69,13,"error"],[67,20,69,18],[67,22,69,20],[68,8,70,6,"console"],[68,15,70,13],[68,16,70,14,"error"],[68,21,70,19],[68,22,70,20],[68,43,70,41],[68,45,70,43,"error"],[68,50,70,48],[68,51,70,49],[69,6,71,4],[69,7,71,5],[69,16,71,14],[70,8,72,6,"setIsLoading"],[70,20,72,18],[70,21,72,19],[70,26,72,24],[70,27,72,25],[71,6,73,4],[72,4,74,2],[72,5,74,3],[73,4,76,2],[73,10,76,8,"login"],[73,15,76,13],[73,18,76,16],[73,24,76,16,"login"],[73,25,76,23,"email"],[73,30,76,36],[73,32,76,38,"password"],[73,40,76,54],[73,45,76,59],[74,6,77,4],[74,10,77,8],[75,8,78,6],[75,14,78,12,"response"],[75,22,78,20],[75,25,78,23],[75,31,78,29,"api"],[75,43,78,32],[75,44,78,32,"api"],[75,47,78,32],[75,48,78,33,"post"],[75,52,78,37],[75,53,78,38],[75,66,78,51],[75,68,78,53],[76,10,78,55,"email"],[76,15,78,60],[77,10,78,62,"password"],[78,8,78,71],[78,9,78,72],[78,10,78,73],[79,8,79,6],[79,14,79,12,"userData"],[79,22,79,20],[79,25,79,23,"response"],[79,33,79,31],[79,34,79,32,"data"],[79,38,79,36],[79,39,79,37,"user"],[79,43,79,41],[80,8,80,6],[80,14,80,12,"AsyncStorage"],[80,26,80,24],[80,27,80,24,"default"],[80,34,80,24],[80,35,80,25,"setItem"],[80,42,80,32],[80,43,80,33],[80,49,80,39],[80,51,80,41,"JSON"],[80,55,80,45],[80,56,80,46,"stringify"],[80,65,80,55],[80,66,80,56,"userData"],[80,74,80,64],[80,75,80,65],[80,76,80,66],[81,8,81,6,"setUser"],[81,15,81,13],[81,16,81,14,"userData"],[81,24,81,22],[81,25,81,23],[82,6,82,4],[82,7,82,5],[82,8,82,6],[82,15,82,13,"error"],[82,20,82,23],[82,22,82,25],[83,8,83,6],[83,14,83,12],[83,18,83,16,"Error"],[83,23,83,21],[83,24,83,22,"error"],[83,29,83,27],[83,30,83,28,"response"],[83,38,83,36],[83,40,83,38,"data"],[83,44,83,42],[83,46,83,44,"detail"],[83,52,83,50],[83,56,83,54],[83,77,83,75],[83,78,83,76],[84,6,84,4],[85,4,85,2],[85,5,85,3],[86,4,87,2],[86,10,87,8,"register"],[86,18,87,16],[86,21,87,19],[86,27,87,26,"userData"],[86,35,87,39],[86,39,87,44],[87,6,88,4],[87,10,88,8],[88,8,89,6],[88,14,89,12,"response"],[88,22,89,20],[88,25,89,23],[88,31,89,29,"api"],[88,43,89,32],[88,44,89,32,"api"],[88,47,89,32],[88,48,89,33,"post"],[88,52,89,37],[88,53,89,38],[88,69,89,54],[88,71,89,56,"userData"],[88,79,89,64],[88,80,89,65],[89,8,90,6],[89,14,90,12,"user"],[89,18,90,16],[89,21,90,19,"response"],[89,29,90,27],[89,30,90,28,"data"],[89,34,90,32],[89,35,90,33,"user"],[89,39,90,37],[90,8,91,6],[90,14,91,12,"AsyncStorage"],[90,26,91,24],[90,27,91,24,"default"],[90,34,91,24],[90,35,91,25,"setItem"],[90,42,91,32],[90,43,91,33],[90,49,91,39],[90,51,91,41,"JSON"],[90,55,91,45],[90,56,91,46,"stringify"],[90,65,91,55],[90,66,91,56,"user"],[90,70,91,60],[90,71,91,61],[90,72,91,62],[91,8,92,6,"setUser"],[91,15,92,13],[91,16,92,14,"user"],[91,20,92,18],[91,21,92,19],[92,6,93,4],[92,7,93,5],[92,8,93,6],[92,15,93,13,"error"],[92,20,93,23],[92,22,93,25],[93,8,94,6],[93,14,94,12],[93,18,94,16,"Error"],[93,23,94,21],[93,24,94,22,"error"],[93,29,94,27],[93,30,94,28,"response"],[93,38,94,36],[93,40,94,38,"data"],[93,44,94,42],[93,46,94,44,"detail"],[93,52,94,50],[93,56,94,54],[93,86,94,84],[93,87,94,85],[94,6,95,4],[95,4,96,2],[95,5,96,3],[96,4,98,2],[96,10,98,8,"logout"],[96,16,98,14],[96,19,98,17],[96,25,98,17,"logout"],[96,26,98,17],[96,31,98,29],[97,6,99,4],[97,10,99,8],[98,8,100,6],[98,14,100,12,"AsyncStorage"],[98,26,100,24],[98,27,100,24,"default"],[98,34,100,24],[98,35,100,25,"removeItem"],[98,45,100,35],[98,46,100,36],[98,52,100,42],[98,53,100,43],[99,8,101,6,"setUser"],[99,15,101,13],[99,16,101,14],[99,20,101,18],[99,21,101,19],[100,6,102,4],[100,7,102,5],[100,8,102,6],[100,15,102,13,"error"],[100,20,102,18],[100,22,102,20],[101,8,103,6,"console"],[101,15,103,13],[101,16,103,14,"error"],[101,21,103,19],[101,22,103,20],[101,42,103,40],[101,44,103,42,"error"],[101,49,103,47],[101,50,103,48],[102,6,104,4],[103,4,105,2],[103,5,105,3],[104,4,107,2],[104,24,108,4],[104,28,108,4,"_reactJsxDevRuntime"],[104,47,108,4],[104,48,108,4,"jsxDEV"],[104,54,108,4],[104,56,108,5,"AuthContext"],[104,67,108,16],[104,68,108,17,"Provider"],[104,76,108,25],[105,6,108,26,"value"],[105,11,108,31],[105,13,108,33],[106,8,108,35,"user"],[106,12,108,39],[107,8,108,41,"isLoading"],[107,17,108,50],[108,8,108,52,"login"],[108,13,108,57],[109,8,108,59,"register"],[109,16,108,67],[110,8,108,69,"logout"],[111,6,108,76],[111,7,108,78],[112,6,108,78,"children"],[112,14,108,78],[112,16,109,7,"children"],[113,4,109,15],[114,6,109,15,"fileName"],[114,14,109,15],[114,16,109,15,"_jsxFileName"],[114,28,109,15],[115,6,109,15,"lineNumber"],[115,16,109,15],[116,6,109,15,"columnNumber"],[116,18,109,15],[117,4,109,15],[117,11,110,26],[117,12,110,27],[118,2,112,0],[119,2,112,1,"_s2"],[119,5,112,1],[119,6,53,16,"AuthProvider"],[119,18,53,28],[120,4,53,28],[120,12,57,2,"useProtectedRoute"],[120,29,57,19],[121,2,57,19],[122,2,57,19,"_c"],[122,4,57,19],[122,7,53,16,"AuthProvider"],[122,19,53,28],[123,2,114,7],[123,11,114,16,"useAuth"],[123,18,114,23,"useAuth"],[123,19,114,23],[123,21,114,26],[124,4,114,26,"_s3"],[124,7,114,26],[125,4,115,2],[125,10,115,8,"context"],[125,17,115,15],[125,20,115,18],[125,24,115,18,"useContext"],[125,30,115,28],[125,31,115,28,"useContext"],[125,41,115,28],[125,43,115,29,"AuthContext"],[125,54,115,40],[125,55,115,41],[126,4,116,2],[126,8,116,6,"context"],[126,15,116,13],[126,20,116,18,"undefined"],[126,29,116,27],[126,31,116,29],[127,6,117,4],[127,12,117,10],[127,16,117,14,"Error"],[127,21,117,19],[127,22,117,20],[127,67,117,65],[127,68,117,66],[128,4,118,2],[129,4,119,2],[129,11,119,9,"context"],[129,18,119,16],[130,2,120,0],[131,2,120,1,"_s3"],[131,5,120,1],[131,6,114,16,"useAuth"],[131,13,114,23],[132,2,114,23],[132,6,114,23,"_c"],[132,8,114,23],[133,2,114,23,"$RefreshReg$"],[133,14,114,23],[133,15,114,23,"_c"],[133,17,114,23],[134,0,114,23],[134,3]],"functionMap":{"names":["<global>","useProtectedRoute","useEffect$argument_0","AuthProvider","loadUser","login","register","logout","useAuth"],"mappings":"AAA;AC0B;YCI;GDmB;CDC;OGE;YDM;GCE;mBCE;GDW;gBEE;GFS;mBGE;GHS;iBIE;GJO;CHO;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}